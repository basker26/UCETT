<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js" integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.rawgit.com/rainabba/jquery-table2excel/1.1.0/dist/jquery.table2excel.min.js"></script>
<script>
    $(function() {
  $(".exportToExcel").click(function(event) {
    console.log("Exporting XLS");
    $("#studentTable").table2excel({
      exclude: ".excludeThisClass",
      name: $("#studentTable").data("tableName"),
      filename: "StudentTable.xls",
      preserveColors: false
    });
  });
});
</script>
<div class="col-11 col-md-2">
    <select  ng-model="dept.dept" class="form-select form-select-sm " aria-label=".form-select-sm example" ng-change="getinfo(dept.dept)">
        <option disabled>Select Department</option>
        <option ng-repeat="d in data.data" value={{d.department}}>{{d.department}}</option>
    </select>
</div>
<div class="row mycard mt-0">
    <style>
        table, th, td {
          border:1px solid black;
        }
        </style>
    <table id="studentTable" class="table2excel" data-tableName="Student Table 1">
        <th>
            Id
        </th>
        <th colspan="10">
            monday
        </th>
        <th colspan="10">
            tuesday
        </th>
        <th colspan="10">
            wednesday
        </th>

        <th colspan="10">
            thursday
        </th>

        <th colspan="10">
            friday
        </th>

        <th colspan="10">
            saturday
        </th>

        <th >
            workload
        </th>



        <tr>
            <td>
                faculty
            </td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
            <td>9</td>
            <td>10</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
            <td>9</td>
            <td>10</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
            <td>9</td>
            <td>10</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
            <td>9</td>
            <td>10</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
            <td>9</td>
            <td>10</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
            <td>9</td>
            <td>10</td>
        </tr>
        <tr ng-repeat="facinfo in deptfaculty">
            <td><h6 ng-repeat="l in facname | filter:{id:facinfo[0]}">{{l.name}}</h6></td>
            <td ng-if="facinfo[1][0].s" ng-attr-colspan="{{facinfo[1][0].d_to - facinfo[1][0].d_from + 1}}">{{facinfo[1][0].info}}</td>
            <td ng-if="facinfo[1][1].s" ng-attr-colspan="{{facinfo[1][1].d_to - facinfo[1][1].d_from + 1}}">{{facinfo[1][1].info}}</td>
            <td ng-if="facinfo[1][2].s" ng-attr-colspan="{{facinfo[1][2].d_to - facinfo[1][2].d_from + 1}}">{{facinfo[1][2].info}}</td>
            <td ng-if="facinfo[1][3].s" ng-attr-colspan="{{facinfo[1][3].d_to - facinfo[1][3].d_from + 1}}">{{facinfo[1][3].info}}</td>
            <td ng-if="facinfo[1][4].s" ng-attr-colspan="{{facinfo[1][4].d_to - facinfo[1][4].d_from + 1}}">{{facinfo[1][4].info}}</td>
            <td ng-if="facinfo[1][5]">LUNCH</td>
            <td ng-if="facinfo[1][6].s" ng-attr-colspan="{{facinfo[1][6].d_to - facinfo[1][6].d_from + 1}}">{{facinfo[1][6].info}}</td>
            <td ng-if="facinfo[1][7].s" ng-attr-colspan="{{facinfo[1][7].d_to - facinfo[1][7].d_from + 1}}">{{facinfo[1][7].info}}</td>
            <td ng-if="facinfo[1][8].s" ng-attr-colspan="{{facinfo[1][8].d_to - facinfo[1][8].d_from + 1}}">{{facinfo[1][8].info}}</td>
            <td ng-if="facinfo[1][9].s" ng-attr-colspan="{{facinfo[1][9].d_to - facinfo[1][9].d_from + 1}}">{{facinfo[1][9].info}}</td>

            <td ng-if="facinfo[2][0].s" ng-attr-colspan="{{facinfo[2][0].d_to - facinfo[2][0].d_from + 1}}">{{facinfo[2][0].info}}</td>
            <td ng-if="facinfo[2][1].s" ng-attr-colspan="{{facinfo[2][1].d_to - facinfo[2][1].d_from + 1}}">{{facinfo[2][1].info}}</td>
            <td ng-if="facinfo[2][2].s" ng-attr-colspan="{{facinfo[2][2].d_to - facinfo[2][2].d_from + 1}}">{{facinfo[2][2].info}}</td>
            <td ng-if="facinfo[2][3].s" ng-attr-colspan="{{facinfo[2][3].d_to - facinfo[2][3].d_from + 1}}">{{facinfo[2][3].info}}</td>
            <td ng-if="facinfo[2][4].s" ng-attr-colspan="{{facinfo[2][4].d_to - facinfo[2][4].d_from + 1}}">{{facinfo[2][4].info}}</td>
            <td ng-if="facinfo[2][5]">LUNCH</td>
            <td ng-if="facinfo[2][6].s" ng-attr-colspan="{{facinfo[2][6].d_to - facinfo[2][6].d_from + 1}}">{{facinfo[2][6].info}}</td>
            <td ng-if="facinfo[2][7].s" ng-attr-colspan="{{facinfo[2][7].d_to - facinfo[2][7].d_from + 1}}">{{facinfo[2][7].info}}</td>
            <td ng-if="facinfo[2][8].s" ng-attr-colspan="{{facinfo[2][8].d_to - facinfo[2][8].d_from + 1}}">{{facinfo[2][8].info}}</td>
            <td ng-if="facinfo[2][9].s" ng-attr-colspan="{{facinfo[2][9].d_to - facinfo[2][9].d_from + 1}}">{{facinfo[2][9].info}}</td>

            <td ng-if="facinfo[3][0].s" ng-attr-colspan="{{facinfo[3][0].d_to - facinfo[3][0].d_from + 1}}">{{facinfo[3][0].info}}</td>
            <td ng-if="facinfo[3][1].s" ng-attr-colspan="{{facinfo[3][1].d_to - facinfo[3][1].d_from + 1}}">{{facinfo[3][1].info}}</td>
            <td ng-if="facinfo[3][2].s" ng-attr-colspan="{{facinfo[3][2].d_to - facinfo[3][2].d_from + 1}}">{{facinfo[3][2].info}}</td>
            <td ng-if="facinfo[3][3].s" ng-attr-colspan="{{facinfo[3][3].d_to - facinfo[3][3].d_from + 1}}">{{facinfo[3][3].info}}</td>
            <td ng-if="facinfo[3][4].s" ng-attr-colspan="{{facinfo[3][4].d_to - facinfo[3][4].d_from + 1}}">{{facinfo[3][4].info}}</td>
            <td ng-if="facinfo[3][5]">LUNCH</td>
            <td ng-if="facinfo[3][6].s" ng-attr-colspan="{{facinfo[3][6].d_to - facinfo[3][6].d_from + 1}}">{{facinfo[3][6].info}}</td>
            <td ng-if="facinfo[3][7].s" ng-attr-colspan="{{facinfo[3][7].d_to - facinfo[3][7].d_from + 1}}">{{facinfo[3][7].info}}</td>
            <td ng-if="facinfo[3][8].s" ng-attr-colspan="{{facinfo[3][8].d_to - facinfo[3][8].d_from + 1}}">{{facinfo[3][8].info}}</td>
            <td ng-if="facinfo[3][9].s" ng-attr-colspan="{{facinfo[3][9].d_to - facinfo[3][9].d_from + 1}}">{{facinfo[3][9].info}}</td>


            <td ng-if="facinfo[4][0].s" ng-attr-colspan="{{facinfo[4][0].d_to - facinfo[4][0].d_from + 1}}">{{facinfo[4][0].info}}</td>
            <td ng-if="facinfo[4][1].s" ng-attr-colspan="{{facinfo[4][1].d_to - facinfo[4][1].d_from + 1}}">{{facinfo[4][1].info}}</td>
            <td ng-if="facinfo[4][2].s" ng-attr-colspan="{{facinfo[4][2].d_to - facinfo[4][2].d_from + 1}}">{{facinfo[4][2].info}}</td>
            <td ng-if="facinfo[4][3].s" ng-attr-colspan="{{facinfo[4][3].d_to - facinfo[4][3].d_from + 1}}">{{facinfo[4][3].info}}</td>
            <td ng-if="facinfo[4][4].s" ng-attr-colspan="{{facinfo[4][4].d_to - facinfo[4][4].d_from + 1}}">{{facinfo[4][4].info}}</td>
            <td ng-if="facinfo[4][5]">LUNCH</td>
            <td ng-if="facinfo[4][6].s" ng-attr-colspan="{{facinfo[4][6].d_to - facinfo[4][6].d_from + 1}}">{{facinfo[4][6].info}}</td>
            <td ng-if="facinfo[4][7].s" ng-attr-colspan="{{facinfo[4][7].d_to - facinfo[4][7].d_from + 1}}">{{facinfo[4][7].info}}</td>
            <td ng-if="facinfo[4][8].s" ng-attr-colspan="{{facinfo[4][8].d_to - facinfo[4][8].d_from + 1}}">{{facinfo[4][8].info}}</td>
            <td ng-if="facinfo[4][9].s" ng-attr-colspan="{{facinfo[4][9].d_to - facinfo[4][9].d_from + 1}}">{{facinfo[4][9].info}}</td>


            <td ng-if="facinfo[5][0].s" ng-attr-colspan="{{facinfo[5][0].d_to - facinfo[5][0].d_from + 1}}">{{facinfo[5][0].info}}</td>
            <td ng-if="facinfo[5][1].s" ng-attr-colspan="{{facinfo[5][1].d_to - facinfo[5][1].d_from + 1}}">{{facinfo[5][1].info}}</td>
            <td ng-if="facinfo[5][2].s" ng-attr-colspan="{{facinfo[5][2].d_to - facinfo[5][2].d_from + 1}}">{{facinfo[5][2].info}}</td>
            <td ng-if="facinfo[5][3].s" ng-attr-colspan="{{facinfo[5][3].d_to - facinfo[5][3].d_from + 1}}">{{facinfo[5][3].info}}</td>
            <td ng-if="facinfo[5][4].s" ng-attr-colspan="{{facinfo[5][4].d_to - facinfo[5][4].d_from + 1}}">{{facinfo[5][4].info}}</td>
            <td ng-if="facinfo[5][5]">LUNCH</td>
            <td ng-if="facinfo[5][6].s" ng-attr-colspan="{{facinfo[5][6].d_to - facinfo[5][6].d_from + 1}}">{{facinfo[5][6].info}}</td>
            <td ng-if="facinfo[5][7].s" ng-attr-colspan="{{facinfo[5][7].d_to - facinfo[5][7].d_from + 1}}">{{facinfo[5][7].info}}</td>
            <td ng-if="facinfo[5][8].s" ng-attr-colspan="{{facinfo[5][8].d_to - facinfo[5][8].d_from + 1}}">{{facinfo[5][8].info}}</td>
            <td ng-if="facinfo[5][9].s" ng-attr-colspan="{{facinfo[5][9].d_to - facinfo[5][9].d_from + 1}}">{{facinfo[5][9].info}}</td>


            <td ng-if="facinfo[6][0].s" ng-attr-colspan="{{facinfo[6][0].d_to - facinfo[6][0].d_from + 1}}">{{facinfo[6][0].info}}</td>
            <td ng-if="facinfo[6][1].s" ng-attr-colspan="{{facinfo[6][1].d_to - facinfo[6][1].d_from + 1}}">{{facinfo[6][1].info}}</td>
            <td ng-if="facinfo[6][2].s" ng-attr-colspan="{{facinfo[6][2].d_to - facinfo[6][2].d_from + 1}}">{{facinfo[6][2].info}}</td>
            <td ng-if="facinfo[6][3].s" ng-attr-colspan="{{facinfo[6][3].d_to - facinfo[6][3].d_from + 1}}">{{facinfo[6][3].info}}</td>
            <td ng-if="facinfo[6][4].s" ng-attr-colspan="{{facinfo[6][4].d_to - facinfo[6][4].d_from + 1}}">{{facinfo[6][4].info}}</td>
            <td ng-if="facinfo[6][5]">LUNCH</td>
            <td ng-if="facinfo[6][6].s" ng-attr-colspan="{{facinfo[6][6].d_to - facinfo[6][6].d_from + 1}}">{{facinfo[6][6].info}}</td>
            <td ng-if="facinfo[6][7].s" ng-attr-colspan="{{facinfo[6][7].d_to - facinfo[6][7].d_from + 1}}">{{facinfo[6][7].info}}</td>
            <td ng-if="facinfo[6][8].s" ng-attr-colspan="{{facinfo[6][8].d_to - facinfo[6][8].d_from + 1}}">{{facinfo[6][8].info}}</td>
            <td ng-if="facinfo[6][9].s" ng-attr-colspan="{{facinfo[6][9].d_to - facinfo[6][9].d_from + 1}}">{{facinfo[6][9].info}}</td>

            <td ng-attr-colspan="10">{{facinfo[7]}}</td>

        </tr>
    </table>
<button class="exportToExcel">Export to XLS</button>
</div>
